# バージョン切替用 map 設定
# 新バージョン追加時はここを更新

# Cookie値に応じてバックエンドポートを振り分け
map $cookie_app_version $backend_port {
    "v0.8.0"  8080;
    default   8080;  # latest (v0.8.0)
}

# Cookie値に応じてフロントエンドを振り分け
# v0.6.0以降はViteビルド済みのdistをマウント先として参照
# latestシンボリックリンクは使用せず、最新バージョンを直接指定
map $cookie_app_version $frontend_root {
    "v0.8.0"  /var/www/spec-code-ai-mapper/versions/v0.8.0/frontend;
    default   /var/www/spec-code-ai-mapper/versions/v0.8.0/frontend;  # latest (v0.8.0)
}
