# Security Policy

## サポートバージョン

セキュリティアップデートは以下のバージョンに対して提供されます。最新バージョンの使用を推奨します。

| バージョン | サポート状況       |
| ---------- | ------------------ |
| 0.1.2      | :white_check_mark: |
| 0.1.1 <    | :x:                |

## 脆弱性の報告

セキュリティ脆弱性を発見した場合、**公開のIssueを作成しないでください**。

### 報告方法

以下のいずれかの方法で報告をお願いします：

1. **GitHubセキュリティアドバイザリ**（推奨）
   - [Security Advisories](https://github.com/elvezjp/code2map/security/advisories/new) から非公開で報告できます

2. **メール**
   - セキュリティチームへ直接連絡: security@elvez.jp

### 報告に含めるべき情報

- **脆弱性の説明**: 問題の概要と種類
- **再現手順**: 問題を再現するための具体的な手順
- **潜在的な影響**: 想定される被害範囲と重大度
- **修正案**（可能であれば）: 緩和策や修正の提案
- **連絡先情報**（任意）: フォローアップのための連絡先

### 報告例

```
件名: [SECURITY] ファイルパス処理における脆弱性

説明:
入力ファイルパスの検証が不十分なため、ディレクトリトラバーサル攻撃が可能です。

再現手順:
1. code2map build "../../../etc/passwd" --out ./out を実行
2. 意図しないファイルが処理される

影響:
任意のファイルが読み取られる可能性があります。重大度: 高

修正案:
入力パスの正規化と、許可されたディレクトリ内かの検証を追加する。
```

## 対応スケジュール

- **初回応答**: 48時間以内
- **状況更新**: 7日以内
- **解決**: 重大度に応じて対応
  - 緊急（Critical）: 14日以内
  - 高（High）: 30日以内
  - 中（Medium）: 60日以内
  - 低（Low）: 次回リリースサイクル

## セキュリティに関する考慮事項

### ファイル処理

- code2mapは指定されたソースファイルを読み取り、解析結果を出力ディレクトリに書き込みます
- 信頼できないソースからのファイルを処理する場合は注意が必要です
- 出力ディレクトリは書き込み権限を持つ安全な場所を指定してください

### 入力検証

- 入力ファイルは拡張子（`.py`, `.java`）に基づいて言語を判定します
- 不正な形式のファイルはパースエラーとして処理されます
- シンボリックリンクの追跡には注意が必要です

### 出力のセキュリティ

- 生成されるMarkdownファイルには元のソースコードの断片が含まれます
- 機密情報を含むソースコードを処理する場合、出力ファイルの取り扱いに注意してください
- `MAP.json`には元ファイルのパス情報が含まれます

### 依存関係

- 依存関係は定期的に脆弱性スキャンを実施しています
- `uv sync`で最新の依存関係を取得できます

## セキュリティのベストプラクティス

code2mapを安全に使用するために、以下の推奨事項を守ってください：

1. **最新バージョンを使用する**: セキュリティ修正が含まれている可能性があります
2. **入力ファイルを確認する**: 信頼できないソースからのファイルを処理する前に内容を確認してください
3. **出力ディレクトリを制限する**: 書き込み先を適切に管理し、機密ディレクトリへの書き込みを避けてください
4. **生成物の取り扱いに注意する**: 出力ファイルには元のソースコードが含まれるため、適切なアクセス制御を設定してください
5. **サンドボックス環境での実行**: 信頼できないコードを処理する場合は、隔離された環境での実行を検討してください

## 既知のセキュリティ制限

- 本ツールは静的解析のみを行い、コードの実行は行いません
- 動的ディスパッチやリフレクションによる依存関係は検出できません
- 悪意のあるコードパターンの検出機能は提供していません

## お問い合わせ

脆弱性ではないセキュリティ関連の質問がある場合：

- GitHubで `security` ラベルを付けてIssueを作成してください
- 一般的な質問はDiscussionsをご利用ください

## 謝辞

セキュリティ脆弱性を報告してくださった研究者の方々に感謝いたします。報告者の希望に応じて、修正リリース時に謝辞を掲載いたします。
